{"title":"æ ‘çŠ¶æ•°ç»„","uid":"36ef81d64d1d0edc64820d5afd16a0b4","slug":"æ ‘çŠ¶æ•°ç»„","date":"2026-01-23T16:00:00.000Z","updated":"2026-01-24T17:58:57.276Z","comments":true,"path":"api/articles/æ ‘çŠ¶æ•°ç»„.json","keywords":null,"cover":null,"content":"<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1. å¼€å…¨å±€æ•°ç»„ï¼Œå¤§å°è¦æ¯”é¢˜ç›®è¦æ±‚çš„ N ç¨å¤§ä¸€ç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">// tree[] å°±æ˜¯æ ‘çŠ¶æ•°ç»„æœ¬ä½“</span></span><br><span class=\"line\"><span class=\"type\">int</span> tree[<span class=\"number\">500005</span>]; </span><br><span class=\"line\"><span class=\"type\">int</span> n; <span class=\"comment\">// é¢˜ç›®ç»™çš„æ•°ç»„é•¿åº¦</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ------------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ã€å‡½æ•° 1ã€‘lowbit</span></span><br><span class=\"line\"><span class=\"comment\">// ä½œç”¨ï¼šç®—å‡º x äºŒè¿›åˆ¶æœ€å³è¾¹çš„ 1 ä»£è¡¨çš„å€¼</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">lowbit</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x &amp; -x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ã€å‡½æ•° 2ã€‘add (å•ç‚¹ä¿®æ”¹)</span></span><br><span class=\"line\"><span class=\"comment\">// ä½œç”¨ï¼šæŠŠç¬¬ x ä¸ªæ•°åŠ ä¸Š k</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// å¾ªç¯ï¼šä» x å¼€å§‹ï¼Œæ¯æ¬¡è·³åˆ°çˆ¶äº²èŠ‚ç‚¹ (i += lowbit(i))</span></span><br><span class=\"line\">    <span class=\"comment\">// è¾¹ç•Œï¼šä¸èƒ½è¶…è¿‡æ€»é•¿åº¦ n</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = x; i &lt;= n; i += <span class=\"built_in\">lowbit</span>(i)) &#123;</span><br><span class=\"line\">        tree[i] += k;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ã€å‡½æ•° 3ã€‘query (å‰ç¼€æ±‚å’Œ)</span></span><br><span class=\"line\"><span class=\"comment\">// ä½œç”¨ï¼šç®—å‡º 1 åˆ° x ä¹‹é—´æ‰€æœ‰æ•°çš„å’Œ</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">// å¾ªç¯ï¼šä» x å¼€å§‹ï¼Œæ¯æ¬¡å‡æ‰å½“å‰ç®¡è¾–é•¿åº¦ (i -= lowbit(i))</span></span><br><span class=\"line\">    <span class=\"comment\">// è¾¹ç•Œï¼šç›´åˆ° i å˜æˆ 0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = x; i &gt; <span class=\"number\">0</span>; i -= <span class=\"built_in\">lowbit</span>(i)) &#123;</span><br><span class=\"line\">        sum += tree[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œaddå‡½æ•°ç”¨æ¥ä¿®æ”¹ç¬¬iä¸ªæ•°ï¼Œqueryå‡½æ•°ç”¨æ¥æ±‚éƒ¨åˆ†å’Œã€‚</p>\n<p>ä¸éš¾å‘ç°ï¼Œæ ‘çŠ¶æ•°ç»„ä¸­<strong>iæ¯æ¬¡æ°å¥½ä»æœ€å°ä¸º1çš„ä½ä¸Šè¿›ä½</strong>å¾—åˆ°çš„ä¸‹æ ‡æ˜¯æ‰€æœ‰åŒ…å«ç¬¬iä¸ªæ•°çš„ï¼Œä¹Ÿå°±æ˜¯å®ƒå…¨éƒ¨çš„ä¸Šçº§ã€‚<br>é‚£ä¹ˆï¼Œå¯¹ç§°åœ°ï¼Œi -&#x3D; lowbit(i)å¾—åˆ°çš„å°±æ˜¯å…¨éƒ¨ä¸‹çº§ã€‚</p>\n<h1 id=\"ä»æ•°ç»„a-i-å»ºæ ‘çš„ä¸¤ç§æ–¹æ¡ˆ\"><a href=\"#ä»æ•°ç»„a-i-å»ºæ ‘çš„ä¸¤ç§æ–¹æ¡ˆ\" class=\"headerlink\" title=\"ä»æ•°ç»„a[i]å»ºæ ‘çš„ä¸¤ç§æ–¹æ¡ˆ\"></a>ä»æ•°ç»„a[i]å»ºæ ‘çš„ä¸¤ç§æ–¹æ¡ˆ</h1><figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//ä¸€ã€</span></span><br><span class=\"line\">    <span class=\"comment\">// 1. å…ˆæŠŠæ ‘çŠ¶æ•°ç»„æ¸…ç©ºï¼ˆå¦‚æœæ˜¯å…¨å±€å˜é‡ï¼Œé»˜è®¤å°±æ˜¯0ï¼Œè¿™æ­¥å¯çœï¼‰</span></span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(tree, <span class=\"number\">0</span>, <span class=\"built_in\">sizeof</span>(tree)); </span><br><span class=\"line\">    <span class=\"comment\">// 2. å€ŸåŠ©addå‡½æ•°åˆå§‹åŒ–</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++) &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i];    <span class=\"comment\">// è¯»å…¥åŸæ•°ç»„</span></span><br><span class=\"line\">        <span class=\"built_in\">add</span>(i, a[i]);   <span class=\"comment\">// ã€æ ¸å¿ƒã€‘ï¼šç›´æ¥æŠŠå€¼â€œåŠ â€è¿›æ ‘çŠ¶æ•°ç»„</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"><span class=\"comment\">//äºŒã€</span></span><br><span class=\"line\">    <span class=\"comment\">// 1. å…ˆæŠŠåŸæ•°ç»„çš„å€¼ç›´æ¥æŠ„ç»™ tree</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++) &#123;</span><br><span class=\"line\">       cin &gt;&gt; a[i];</span><br><span class=\"line\">        tree[i] = a[i]; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 2. æŒ‰ç…§æ ‘å½¢ç»“æ„ï¼Œè®©å„¿å­æŠŠå€¼åŠ ç»™çˆ¶äº²</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> father = i + <span class=\"built_in\">lowbit</span>(i); <span class=\"comment\">// æ‰¾åˆ°å®ƒæ‰€æœ‰çš„ç›´æ¥ä¸Šçº§</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (father &lt;= n) &#123;</span><br><span class=\"line\">            tree[father] += tree[i]; </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"è®¿é—®æ‰€æœ‰içš„å­èŠ‚ç‚¹\"><a href=\"#è®¿é—®æ‰€æœ‰içš„å­èŠ‚ç‚¹\" class=\"headerlink\" title=\"è®¿é—®æ‰€æœ‰içš„å­èŠ‚ç‚¹\"></a>è®¿é—®æ‰€æœ‰içš„å­èŠ‚ç‚¹</h1><figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å‡è®¾æˆ‘ä»¬è¦æ‰¾ x çš„æ‰€æœ‰ç›´æ¥å„¿å­</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">get_children</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> lx = <span class=\"built_in\">lowbit</span>(x); </span><br><span class=\"line\">    <span class=\"comment\">// éå†æ‰€æœ‰æ¯” lowbit(x) å°çš„ 2 çš„å¹‚æ¬¡</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">1</span>; k &lt; lx; k &lt;&lt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> child = x - k;</span><br><span class=\"line\">    <span class=\"comment\">//è¿™é‡Œçš„æ¯ä¸ªchildéƒ½æ˜¯å­èŠ‚ç‚¹çš„ä¸‹æ ‡</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">æ³¨æ„ï¼Œå¯¹ä»»æ„child,åªè¦child + <span class=\"built_in\">lowbit</span>(child) = x,é‚£childå°±æ˜¯xçš„å­èŠ‚ç‚¹ã€‚å…¶ä¸­ï¼Œ<span class=\"built_in\">lowbit</span>(child)æ˜¯<span class=\"number\">2</span>çš„æ¬¡æ–¹ã€‚</span><br><span class=\"line\">æ‰€ä»¥è¦æ‰¾åˆ°æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œåªè¦ç”¨ x å‡å»æ‰€æœ‰æ¯”å®ƒå°çš„ <span class=\"number\">2</span>çš„æ¬¡å¹‚ å³å¯ã€‚</span><br></pre></td></tr></table></figure>","feature":true,"text":"12345678910111213141516171819202122232425262728293031323334// 1. å¼€å…¨å±€æ•°ç»„ï¼Œå¤§å°è¦æ¯”é¢˜ç›®è¦æ±‚çš„...","permalink":"/post/æ ‘çŠ¶æ•°ç»„","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[{"name":"æ¿å­","slug":"æ¿å­","count":2,"path":"api/categories/æ¿å­.json"},{"name":"ç®—æ³•","slug":"æ¿å­/ç®—æ³•","count":2,"path":"api/categories/æ¿å­/ç®—æ³•.json"}],"tags":[{"name":"æ ‘çŠ¶æ•°ç»„","slug":"æ ‘çŠ¶æ•°ç»„","count":1,"path":"api/tags/æ ‘çŠ¶æ•°ç»„.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BB%8E%E6%95%B0%E7%BB%84a-i-%E5%BB%BA%E6%A0%91%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%A1%88\"><span class=\"toc-text\">ä»æ•°ç»„a[i]å»ºæ ‘çš„ä¸¤ç§æ–¹æ¡ˆ</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E8%AE%BF%E9%97%AE%E6%89%80%E6%9C%89i%E7%9A%84%E5%AD%90%E8%8A%82%E7%82%B9\"><span class=\"toc-text\">è®¿é—®æ‰€æœ‰içš„å­èŠ‚ç‚¹</span></a></li></ol>","author":{"name":"LHY","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/256316666?s=400&u=531212165de7b7b90dc6ec2dd44404fc88f4a435&v=4","link":"/","description":"å¤©ç©ºä¸­çš„å®çŸ³åº”è¯¥äº¤ç”±å¤©ç©ºå»å¯»æ‰¾","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"ç¬¬24æ¬¡CCFCSP T4:çº¿æ®µæ ‘","uid":"fc6239ad7ae370c627b28fb8b9b9b920","slug":"ç¬¬24æ¬¡CCFCSP T4ï¼šçº¿æ®µæ ‘","date":"2026-01-23T16:00:00.000Z","updated":"2026-01-24T16:13:09.363Z","comments":true,"path":"api/articles/ç¬¬24æ¬¡CCFCSP T4ï¼šçº¿æ®µæ ‘.json","keywords":null,"cover":null,"text":" å»ºæ ‘å‡½æ•° 1234567891011121314151617181920void tree_build(int i,long long l,long long...","permalink":"/post/ç¬¬24æ¬¡CCFCSP T4ï¼šçº¿æ®µæ ‘","photos":[],"count_time":{"symbolsCount":702,"symbolsTime":"1 mins."},"categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","count":4,"path":"api/categories/ç®—æ³•.json"},{"name":"CSPçœŸé¢˜","slug":"ç®—æ³•/CSPçœŸé¢˜","count":2,"path":"api/categories/ç®—æ³•/CSPçœŸé¢˜.json"}],"tags":[{"name":"çº¿æ®µæ ‘","slug":"çº¿æ®µæ ‘","count":2,"path":"api/tags/çº¿æ®µæ ‘.json"}],"author":{"name":"LHY","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/256316666?s=400&u=531212165de7b7b90dc6ec2dd44404fc88f4a435&v=4","link":"/","description":"å¤©ç©ºä¸­çš„å®çŸ³åº”è¯¥äº¤ç”±å¤©ç©ºå»å¯»æ‰¾","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"å‰ç¼€å’Œã€å­é›†å’Œä»¥åŠDP","uid":"497c15de710957392d86e4d03043dcbb","slug":"å‰ç¼€å’Œã€å­é›†å’Œä»¥åŠDP","date":"2026-01-22T16:00:00.000Z","updated":"2026-01-23T18:31:27.845Z","comments":true,"path":"api/articles/å‰ç¼€å’Œã€å­é›†å’Œä»¥åŠDP.json","keywords":null,"cover":null,"text":"å‰ç¼€å’Œè®° é‚£ä¹ˆ å°±è¡¨ç¤ºäº†kç»´çš„å‰ç¼€å’Œï¼Œéœ€è¦ä½¿ç”¨éƒ¨åˆ†å’Œæ—¶ç›´æ¥å°†ä¸‹æ ‡è¾“å…¥è®¡ç®—å·®å€¼å³å¯ã€‚ æœ¬è´¨å³ç©ºé—´æ¢æ—¶é—´ å­é›†å’Œè€ƒè™‘å¤§å°ä¸º ğ‘› çš„é›†åˆçš„å…¨ä½“å­é›†ä¸Šé¢å®šä¹‰çš„å‡½æ•° ğ‘“ ...","permalink":"/post/å‰ç¼€å’Œã€å­é›†å’Œä»¥åŠDP","photos":[],"count_time":{"symbolsCount":451,"symbolsTime":"1 mins."},"categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","count":4,"path":"api/categories/ç®—æ³•.json"}],"tags":[{"name":"å‰ç¼€å’Œ","slug":"å‰ç¼€å’Œ","count":1,"path":"api/tags/å‰ç¼€å’Œ.json"},{"name":"DP","slug":"DP","count":2,"path":"api/tags/DP.json"}],"author":{"name":"LHY","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/256316666?s=400&u=531212165de7b7b90dc6ec2dd44404fc88f4a435&v=4","link":"/","description":"å¤©ç©ºä¸­çš„å®çŸ³åº”è¯¥äº¤ç”±å¤©ç©ºå»å¯»æ‰¾","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}